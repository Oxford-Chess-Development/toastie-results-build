(this["webpackJsonptoastie-results"]=this["webpackJsonptoastie-results"]||[]).push([[0],{11:function(e,t,a){e.exports={wrapper:"chesscom_wrapper__3vwwR",container:"chesscom_container__AGg5n",boardLabel:"chesscom_boardLabel__1N2Qy",board:"chesscom_board__3LGEQ","fade-in":"chesscom_fade-in__15-gn",row:"chesscom_row__17flm",square:"chesscom_square___JdY5",W:"chesscom_W__1Kbfl",B:"chesscom_B__misXA"}},18:function(e){e.exports=JSON.parse('{"b":"http://localhost:8080/","a":"https://api.oxfordchess.co.uk/","c":true}')},24:function(e,t,a){},37:function(e,t,a){e.exports=a.p+"static/media/watch.ddf443c3.svg"},46:function(e,t,a){e.exports=a(93)},51:function(e,t,a){},93:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),c=a(39),s=a.n(c),l=(a(51),a(43)),o=a(9),u=a(3),i=a.n(u),m=a(10),d=a(15),b=a(4),f=(a(24),a(40)),h=a.n(f),p=a(41),v=a.n(p),E=/chess\.com\/(?:live#tm=|club\/matches\/live\/(?:[a-z-]+\/)?)([0-9]+)/,w=a(11),j=a.n(w),O=a(12),g=a(20),k=new v.a({queue:!0});function y(e,t){return x.apply(this,arguments)}function x(){return(x=Object(m.a)(i.a.mark((function e(t,a){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){k.dispatch(k.getTeamLiveMatchBoard,(function(t,a){if(a)return n(a);e(t.body)}),[t,a])})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function _(e){return N.apply(this,arguments)}function N(){return(N=Object(m.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,a){k.dispatch(k.getTeamLiveMatch,(function(t,n){if(n)return a(n);e(t.body)}),[t])})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var S=new Map([["p",r.a.createElement(O.e,null)],["n",r.a.createElement(O.d,null)],["b",r.a.createElement(O.a,null)],["r",r.a.createElement(O.g,null)],["q",r.a.createElement(O.f,null)],["k",r.a.createElement(O.c,null)]]);function L(e){var t=Object(n.useReducer)((function(e,t){var a=e.slice(0);return a[t.board]={boardScores:t.boardScores,game:t.game},a}),[]),a=Object(b.a)(t,2),c=a[0],s=a[1],l=Object(n.useState)(""),o=Object(b.a)(l,2),u=o[0],f=o[1],p=Object(n.useState)(0),v=Object(b.a)(p,2),w=v[0],k=v[1],x=Object(n.useReducer)((function(e,t){return e[t.i]=t.name,e}),["",""]),N=Object(b.a)(x,2),L=N[0],C=N[1],R=Object(n.useReducer)((function(e,t){var a=Object.assign({},e);return a[t.player.username.toLowerCase()]=t.team,a}),{}),T=Object(b.a)(R,2),B=T[0],M=T[1],P=Object(n.useState)(20),W=Object(b.a)(P,2),D=W[0],U=W[1],q=Object(n.useState)(!1),I=Object(b.a)(q,2),A=I[0],J=I[1],F=Object(n.useReducer)((function(e,t){var a=e.slice(0);return a[t.board]=t.set,a}),[]),G=Object(b.a)(F,2),Y=G[0],Q=G[1],z=Object(n.useCallback)(Object(m.a)(i.a.mark((function t(){var a,n,r,c,s,l;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=e.matchURL.match(E)){t.next=3;break}return t.abrupt("return",console.error("Invalid URL: ",e.matchURL));case 3:return n=Number(a[1]),t.prev=4,t.next=7,_(n);case 7:for(r=t.sent,k(n),r.boards&&U(r.boards),c=function(){var e=l[s],t=L.findIndex((function(t){return!t||t===e.name}));C({name:e.name,i:t});var a,n=Object(d.a)(e.players);try{for(n.s();!(a=n.n()).done;){var r=a.value;M({player:r,team:t})}}catch(c){n.e(c)}finally{n.f()}},s=0,l=Object.values(r.teams);s<l.length;s++)c();"finished"!==r.status&&"scheduled"!==r.status||J(!0),t.next=19;break;case 15:t.prev=15,t.t0=t.catch(4),console.error(t.t0),f("Match has not yet started!");case 19:case"end":return t.stop()}}),t,null,[[4,15]])}))),[e.matchURL,L]);Object(n.useEffect)((function(){z()}),[z]);var K=Object(n.useCallback)(Object(m.a)(i.a.mark((function e(){var t,a,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(w&&D){e.next=2;break}return e.abrupt("return");case 2:if(!A||!c.length){e.next=4;break}return e.abrupt("return");case 4:t=i.a.mark((function e(t){var a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Y[t]){e.next=2;break}return e.abrupt("return","continue");case 2:if(a=y(w,t).then((function(e){var a=e.games[e.games.length-1];return s({game:a,boardScores:e.board_scores,board:t}),Date.now()>a.end_time&&Q({board:t,set:!0}),!0})).catch((function(e){return!e.message.includes("doesn't have board")||(U(t-1),!1)})),20!==D){e.next=9;break}return e.next=6,a;case 6:if(e.t0=e.sent,!1!==e.t0){e.next=9;break}return e.abrupt("return","break");case 9:case"end":return e.stop()}}),e)})),a=1;case 6:if(!(a<D+1)){e.next=17;break}return e.delegateYield(t(a),"t0",8);case 8:n=e.t0,e.t1=n,e.next="continue"===e.t1?12:"break"===e.t1?13:14;break;case 12:return e.abrupt("continue",14);case 13:return e.abrupt("break",17);case 14:a++,e.next=6;break;case 17:case"end":return e.stop()}}),e)}))),[w,D,A,Y,c.length]);return Object(n.useEffect)((function(){var e=setInterval(K,1e3);return function(){return clearInterval(e)}}),[K]),u||!c.length?r.a.createElement("div",null,u):r.a.createElement("div",{className:j.a.container},c.map((function(e,t){var a=Object.entries(e.boardScores),n=e.game,c=B[n.black.username.toLowerCase()],s=r.a.createElement(r.a.Fragment,null,n.white.username," (",n.white.rating,")"," ",r.a.createElement(g.b,null)),l=r.a.createElement(r.a.Fragment,null,n.black.username," (",n.black.rating,")"," ",r.a.createElement(g.a,null));c&&(a=a.reverse());var o=new h.a(n.fen).board;return r.a.createElement("div",{className:j.a.wrapper},r.a.createElement("div",{className:j.a.boardLabel},r.a.createElement("span",{className:"bold"},a[0][1]),r.a.createElement("a",{href:"https://www.chess.com/live/game/"+n.url.split("/").pop(),target:"_blank",rel:"noopener noreferrer"},r.a.createElement(O.b,null)),r.a.createElement("span",{className:"bold"},a[1][1])),r.a.createElement("div",null,c?s:l," ",L[0]),r.a.createElement("div",{className:j.a.board},o.map((function(e){return r.a.createElement("div",{className:j.a.row},e.map((function(e){return r.a.createElement("div",{className:[j.a.square,j.a[(t=e,t.toLowerCase()===t?"B":"W")]].join(" ")},S.get(e.toLowerCase()));var t})))}))),r.a.createElement("div",null,c?l:s," ",L[1]))})))}var C=a(17),R=a.n(C),T=a(18),B=function(){};console.log("isDev",!1);var M=T.a;function P(e){return e=Object.assign(e,{method:"GET"}),R()(e).then((function(e){return e.data})).catch((function(e){var t;throw console.error(e),e.response&&B([e.response.status,e.response.statusText,":","/"+(null===(t=e.response.config.url)||void 0===t?void 0:t.split("/").pop())].join(" ")),e}))}R.a.defaults.baseURL=M;var W=a(42),D=a(37),U=a.n(D);function q(e){var t=e.match.params.id,a=Object(n.useState)(!1),c=Object(b.a)(a,2),s=c[0],l=c[1],o=Object(n.useState)({}),u=Object(b.a)(o,2),f=(u[0],u[1],Object(n.useState)({})),h=Object(b.a)(f,2),p=(h[0],h[1],Object(n.useState)({})),v=Object(b.a)(p,2),w=v[0],j=v[1],O=Object(n.useState)([]),g=Object(b.a)(O,2),k=g[0],y=g[1],x=Object(n.useState)([]),N=Object(b.a)(x,2),S=N[0],C=N[1],R=Object(n.useMemo)((function(){if(!k.length)return new Map;var e,t=new Map,a=Object(d.a)(k);try{for(a.s();!(e=a.n()).done;){var n=e.value;t.set(n.id,n)}}catch(r){a.e(r)}finally{a.f()}return t}),[k]),T=Object(n.useReducer)((function(e,t){var a=t.id,n=t.time,r=Object.assign({},e);return r[a]=n,r}),{}),B=Object(b.a)(T,2),M=B[0],D=B[1],q=Object(n.useCallback)(Object(m.a)(i.a.mark((function t(){var a,n,r;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a=Object(d.a)(S),t.prev=1,r=function(){var t=n.value,a=Object.values(t[2]).find((function(e){return e}));if(!a)return"continue";var r=a.match(E);a=r?"https://www.chess.com/club/matches/live/"+r[1]:"",_(Number(r[1])).then((function(e){return D({id:r[1],time:e.start_time})})).catch(function(){var t=Object(m.a)(i.a.mark((function t(n){var c;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!n.message.includes("not found")){t.next=7;break}return t.next=3,P({url:"/tournament/"+e.match.params.id+"/scrapeChessComTeamPage",params:{url:a}});case 3:c=t.sent,D({id:r[1],time:new Date(c["Start Time"]).valueOf()}),t.next=8;break;case 7:console.error(n);case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},a.s();case 4:if((n=a.n()).done){t.next=10;break}if("continue"!==r()){t.next=8;break}return t.abrupt("continue",8);case 8:t.next=4;break;case 10:t.next=15;break;case 12:t.prev=12,t.t0=t.catch(1),a.e(t.t0);case 15:return t.prev=15,a.f(),t.finish(15);case 18:case"end":return t.stop()}}),t,null,[[1,12,15,18]])}))),[S,D]);Object(n.useEffect)((function(){q()}),[q]),Object(n.useEffect)((function(){Promise.all([P({url:"/tournament/"+t+"/fetchPlayers"}).then(y).catch((function(){})),P({url:"/tournament/"+t+"/getPairings"}).then(C).catch((function(){})),P({url:"/tournament/"+t+"/getStatus"}).then(j).catch((function(){}))]).then((function(){return l(!0)}))}),[C,y]);var I=w.round||0,A=Object(n.useState)(""),J=Object(b.a)(A,2),F=J[0],G=J[1];return Object(n.useEffect)((function(){if(I){for(var e=new Array(I+1),t=1;t<I+1;t++)e[t]={match:0,game:0};R.set("bye",{id:"bye",firstName:"BYE",histories:e})}}),[R,I]),s?r.a.createElement("div",{id:"main"},r.a.createElement("div",{className:"container"},r.a.createElement("h1",null,w.name),r.a.createElement("section",null,r.a.createElement("h2",null,"Pairings"),r.a.createElement("p",null,"All times in ",new Date(Date.now()).toString().slice(25)),r.a.createElement("table",{className:"download-table full-width"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("td",{style:{width:"27.5%"}},"White"),r.a.createElement("td",{style:{width:"12.5%"}}),r.a.createElement("td",{style:{width:"5%"}}),r.a.createElement("td",{style:{width:"10%"}}),r.a.createElement("td",{style:{width:"5%"}}),r.a.createElement("td",{style:{width:"12.5%"}}),r.a.createElement("td",{style:{width:"27.5%"}},"Black"))),r.a.createElement("tbody",null,S.map((function(e,t){var a,n,c,s=[e[0].trim(),e[1].trim()].join("."),l=R.get(e[0].trim()),o=R.get(e[1].trim()),u=Object.values(e[2]).find((function(e){return e})),i=null===(a=u)||void 0===a?void 0:a.match(E);u=i?"https://www.chess.com/club/matches/live/"+i[1]:"";var m=i?M[i[1]]:0;return r.a.createElement(r.a.Fragment,null,r.a.createElement("tr",{key:["row",t].join(".")},r.a.createElement("td",null,r.a.createElement("div",{className:"playerName"},null===l||void 0===l?void 0:l.firstName)),r.a.createElement("td",{style:{padding:0}},u?r.a.createElement("a",{className:"button",href:u.trim(),target:"_blank",rel:"noopener noreferrer"},r.a.createElement("img",{className:"icon",src:U.a,alt:"Watch games"})):null),r.a.createElement("td",{className:"bold"},null===l||void 0===l||null===(n=l.histories[I])||void 0===n?void 0:n.game),r.a.createElement("td",null,m?new Date(m).toString().slice(0,21):"-"),r.a.createElement("td",{className:"bold"},null===o||void 0===o||null===(c=o.histories[I])||void 0===c?void 0:c.game),r.a.createElement("td",{style:{padding:0}},u?r.a.createElement("div",{className:"button",onClick:function(){return G(F?"":s)}},r.a.createElement(W.a,{style:{transform:F===s?"rotate(-90deg)":"rotate(0deg)"}})):null),r.a.createElement("td",null,r.a.createElement("div",{className:"playerName"},null===o||void 0===o?void 0:o.firstName))),u&&F===s?r.a.createElement("tr",null,r.a.createElement("td",{colSpan:100},(e[2].chessComLink||e[2].chessComTeamLink)&&e[2].chessComTeamLink?r.a.createElement(L,{matchURL:e[2].chessComTeamLink}):null)):null)}))))))):null}var I=function(){return r.a.createElement(l.a,{basename:""},r.a.createElement(o.a,{render:function(e){var t=e.location;return r.a.createElement(o.c,{location:t},r.a.createElement(o.a,{exact:!0,path:"/tournament/:id/",render:function(e){return r.a.createElement(q,e)}}))}}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(I,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[46,1,2]]]);
//# sourceMappingURL=main.75e46240.chunk.js.map